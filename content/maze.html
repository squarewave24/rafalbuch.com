<html>
<style>
  #tableDiv table { border-spacing: 0; border-collapse: collapse;}
  #tableDiv td { border: 1px solid #dfdfdf; padding: 10px;}
  .alt { background-color: #EBFFF6;}
  /*#tableDiv table tr:nth-child(1) {
    background-color: #ccf;
  }
  #outputTextDiv { font-size: .8em; color: #666666;}*/
</style>

<script>
	var _numbers = [
			// [6,3,2,4,6,2,5],
			// [3,5,2,4,4,4,1],
			// [3,3,2,3,3,4,2],
			// [3,4,1,2,2,5,3],
			// [4,4,4,2,3,2,4],
			// [2,5,4,2,3,2,5],
			// [3,5,2,1,4,4,9]
			[2,2,1],
			[1,2,2],
			[2,2,0]
		];

	for (var i=0; i<_numbers.length; i++) {// rows
		for (var j=0; j<_numbers[i].length; j++) {// cols

			// document.write(_numbers[i][j], '&nbsp;');
			
			_numbers[i][j] = { x: j, y: i, v: _numbers[i][j], toString: function(){return this.x + ':' + this.y;}};
		}
			// document.write('<br />');

	}


  function createMazeHtml(){
    var html = '<table>'
    for (var i=0; i<_numbers.length; i++) { // rows
      html += '<tr>'
      for (var j=0; j<_numbers[i].length; j++) { // cols
        
        var cellStyle = ((i+j) % 2) == 0 ? '' : ' class="alt" ';
        console.log(i, j, i+j, i+j %2);
        
        html += '<td ' +  cellStyle + '>' + _numbers[i][j].v + '</td>'
      }
      html += '</tr>'
    }
    html += '</table>';
    
    var d = document.createElement('div');
    d.innerHTML = html;
    return d;
  }
  function writeOutput(text) {
    var d = document.createElement('div');
    d.innerHTML = text;
    
    document.getElementById('outputTextDiv').appendChild(d);
  }
  
  
	

	function move(node, direction, history) {

		var nextNode = getNextNode(node, direction);
		if (!nextNode) 
			return; // no node exists at that address

		if (history.some(function(o){
			return o === nextNode;
		})){
			console.log('terminating', node.toString(), direction, nextNode.toString(), JSON.stringify(history));
			return; // infinite loop detected, terminate!
		}
	
	    history.push(node);

		if (nextNode.v == 0){
      history.push(nextNode);
			printWinner(history);
			
		}

		move(nextNode, 'up', history);
		move(nextNode, 'down', history);
		move(nextNode, 'right', history);
		move(nextNode, 'left', history);

		
	}

	function getNextNode(node, direction){
		var nextNode = null;
		if (node.v < 1) return nextNode;
		switch(direction){
			case 'up':
		      if (node.y - node.v > -1)
		      		nextNode = _numbers[node.y - node.v][node.x];
		      break;
		    case 'down':
		      if (node.y + node.v < _numbers.length)
		      		nextNode = _numbers[node.y + node.v][node.x];
		      break;
		    case 'left':
		      if (node.x - node.v > -1)
		      		nextNode = _numbers[node.y][node.x - node.v];
		      break;
		    case 'right':
		      if (node.x + node.v < _numbers.length)
		       		nextNode = _numbers[node.y][node.x + node.v];
		      break;
		    default:
		      console.error('bad direction supplied: ', direction);
		}

		return nextNode;
	}

	function printWinner(history){
		writeOutput('solved in ' + history.length + ' moves: ' + 
      history.map(
        function(el) { return '[' + el.x + ':' + el.y + ']'; }
        )
      );
 		

	}

	


</script>

<body>
<div id="tableDiv">
</div>
<div id="outputTextDiv"></div>

<script>
  document.getElementById('tableDiv').appendChild(createMazeHtml());
  var first = _numbers[0][0];
  
  move(first, 'down', []);
  move(first, 'right', []);
</script>


</body>

</html>



